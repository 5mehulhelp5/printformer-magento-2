(function(b){if(typeof define==="function"&&define.amd){define(["jquery","jquery/ui","Magento_Ui/js/modal/modal","mage/translate"],b)}else{b(jQuery)}}(function(c){var d=function(a,b,f){this.element=(a instanceof c)?a:c(a);this.options=f;return this.init(b)};d.prototype={init:function(a){if(a=="session"){return this.sessionData()}else{if(a=="preselect"){return this.preselect()}else{return this}}},isDefined:function(a){return typeof a!==typeof undefined},preselect:function(){return this.preselectAction.init(this,this.options)},sessionData:function(){return this.sessionDataAction.init(this,this.options)}};d.prototype.preselectAction={init:function(a,b){this.parentObject=a;this.options=b;return this},initButton:function(){var b=this;var a=b.options.saveUrl;c(this.parentObject.element).click(function(){var f=b.getAllOptions();c.ajax({url:a,method:"post",data:{product_options:JSON.stringify(f)}}).done(function(e){})});return this},getPreselectedOptions:function(){var a=this;if(typeof this.options.preselected!=typeof undefined&&typeof this.options.preselected.product_options!=typeof undefined){var b=this.options.preselected.product_options;a.preselectOptions(b);c(document).trigger("printformer_preselect_options_after")}else{c.ajax({url:this.options.optionsUrl,method:"get",dataType:"json"}).done(function(f){a.preselectOptions(f);c(document).trigger("printformer_preselect_options_after");return true})}return this},preselectOptions:function(p){var l=this;if(p!=null){if(this.parentObject.isDefined(p)){if(p.product==this.options.currentProduct){var b=false;var o=".price-model-box";if(c(o).length){b=true;var q=c(o).find(":input");c.each(q,function(g,e){if(c(e).attr("type")=="radio"){var f=c(e).val();if(l.parentObject.isDefined(p.pricemodel)){if(l.parentObject.isDefined(p.pricemodel.value)){if(f.length&&f==p.pricemodel.value){c(e).prop("checked",true)}}}}})}if(this.parentObject.isDefined(p.qty)&&this.parentObject.isDefined(p.qty.value)){var m="#qty";if(c(m).length){c(m).val(p.qty.value);c(m).trigger("change")}}var n=".product-fees";if(c(n).length){var r=c(n).children(".fee.field");c.each(r,function(g,f){var e=c(f).children(".fee-option");var h=c(e).data("fee-id");if(typeof p.product_fees!==typeof undefined&&typeof p.product_fees[h]!==typeof undefined){if(p.product_fees[h].value==true){c(e).prop("checked",true)}}})}var a=c(".product-options-wrapper :input");c.each(a,function(e,f){if(c(f).hasClass("product-custom-option")&&c(f).attr("type")=="checkbox"){var g=c(f).attr("id");if(l.parentObject.isDefined(p[g])&&p[g].value==c(f).val()){c(f).prop("checked",true)}}if(c(f).prop("tagName").toLowerCase()=="select"&&c(f).hasClass("product-custom-option")){c.each(p,function(i,h){if(c(f).data("selector")=="options["+i+"]"){c(f).val(h.value)}})}if(c(f).hasClass("product-custom-option")&&c(f).attr("type")=="radio"){c.each(p,function(i,h){if(c(f).data("selector")=="options["+i+"]"&&c(f).val()==h.value){c(f).prop("checked",true)}})}c(f).trigger("change")})}}}return this},getAllOptions:function(){var a=c(".product-options-wrapper .product-custom-option");var r={};r.product=this.options.currentProduct;var l=[];c.each(c(a),function(i,h){var e=null,g=null,f=null;if(c(h).prop("tagName").toLowerCase()=="select"){e=c(h).attr("data-selector").match(/options\[(\d+)\]/);g=e[1];f=c(h).val();if(f.length){r[g]={value:f}}}if(c(h).attr("type")=="radio"){if(c(h).prop("checked")){e=c(h).attr("data-selector").match(/options\[(\d+)\]/);g=e[1];f=c(h).val();if(f.length){r[g]={value:f}}}}if(c(h).attr("type")=="checkbox"){l.push(h)}});c.each(l,function(e,g){if(c(g).prop("checked")){var f=c(g).val();if(f.length){r[c(g).attr("id")]={value:f}}}});var b="#qty";if(c(b).length){var o=c(b).val();if(o.length){r.qty={value:o}}}var m=".product-fees";if(c(m).length){var q=c(m).children(".fee.field");c.each(q,function(g,f){var e=c(f).children(".fee-option");var h=c(e).data("fee-id");if(c(e).prop("checked")){if(!(typeof r.product_fees=="object")){r.product_fees={}}r.product_fees[h]={value:c(e).prop("checked")}}})}var n=".price-model-box";if(c(n).length){var p=c(n).find(":input");c.each(p,function(g,e){if(c(e).attr("type")=="radio"){if(c(e).prop("checked")){var h=c(e).attr("data-selector").match(/options\[(\d+)\]/);var f=c(e).val();if(f.length){r.pricemodel={value:f}}}}})}return r}};d.prototype.sessionDataAction={init:function(a,b){this.parentObject=a;this.options=b;this.initButton();return this},initButton:function(){var a=this;return this},getSavedEditorCalls:function(b){var a=this;c(this.parentObject.element).click(function(e){e.preventDefault();c.ajax({url:b,method:"get",dataType:"json"}).done(function(m){if(m!==null){var n=c("<div/>").html("<h2>"+c.mage.__("You've made two Drafts. Please select the one you want to add to cart.")+"</h2>");var k=c("<select/>");var f=[];var l=0;c.each(m,function(p,i){var g=i.draft_id;var j=i.intent;var h=c("<option/>").val(g).text(c.mage.__("draft-"+p)).data("pf-intent",j);f[g]=j;c(k).append(c(h));l++});c(n).append(c(k));if(l>1){c(n).modal({autoOpen:true,responsive:true,clickableOverlay:true,type:"popup",buttons:[{text:c.mage.__("Confirm"),attr:{"data-action":"confirm"},"class":"action-primary",click:function(){var h=c("#printformer_draftid");var g=c("#printformer_intent");if(c(h).length&&c(g).length){c(h).val(c(k).val());c(g).val(f[c(k).val()])}this.closeModal();a.deleteDraftSessionAndSubmit(b,c(k).val())}}]})}else{a.deleteDraftSessionAndSubmit(b)}}else{a.deleteDraftSessionAndSubmit(b)}});return false});return this},deleteDraftSessionAndSubmit:function(b,f){var a=b+"?delete=true";if(typeof f!=typeof undefined&&f!=null){a+="&excludeDraft="+f}c.ajax({url:a,method:"get",dataType:"json"}).done(function(){c("#product_addtocart_form").trigger("submit")})}};return d}));